# CKA 2025 í†µí•© ì‹¤ìŠµ ë¬¸ì œì§‘

## ğŸ¯ KillerCoda Playground ì‹¤ìŠµ ê°€ì´ë“œ

**ì‚¬ìš©ë²•:**
1. **KillerCoda Kubernetes Playground** ì ‘ì†: https://killercoda.com/playgrounds/scenario/kubernetes
2. ê° ë¬¸ì œì˜ **í™˜ê²½ ì„¤ì •** ëª…ë ¹ì–´ë¥¼ ì‹¤í–‰í•˜ì—¬ ë¬¸ì œ ìƒí™© ìƒì„±
3. **ë¬¸ì œ**ë¥¼ ì½ê³  í•´ê²° ì‹œë„
4. **ì†”ë£¨ì…˜**ì„ ì°¸ê³ í•˜ì—¬ ê²€ì¦5

---

## ğŸ“‹ ëª©ì°¨

### Part 1: ê¸°ë³¸ ì‹¤ìŠµ (1-10ë²ˆ)
- [CNI ì„¤ì¹˜](#ë¬¸ì œ-1-cni-ì„¤ì¹˜)
- [Helm í…œí”Œë¦¿ ìƒì„±](#ë¬¸ì œ-2-helm-í…œí”Œë¦¿-ìƒì„±)
- [HPA êµ¬ì„±](#ë¬¸ì œ-3-hpa-êµ¬ì„±)
- [Sidecar ì»¨í…Œì´ë„ˆ](#ë¬¸ì œ-4-sidecar-ì»¨í…Œì´ë„ˆ)
- [PriorityClass êµ¬ì„±](#ë¬¸ì œ-5-priorityclass-êµ¬ì„±)
- [Pod Security Admission](#ë¬¸ì œ-6-pod-security-admission)
- [Taintì™€ Toleration](#ë¬¸ì œ-7-taintì™€-toleration)
- [NetworkPolicy êµ¬í˜„](#ë¬¸ì œ-8-networkpolicy-êµ¬í˜„)
- [StorageClass êµ¬ì„±](#ë¬¸ì œ-9-storageclass-êµ¬ì„±)
- [JSONPath ì¿¼ë¦¬](#ë¬¸ì œ-10-jsonpath-ì¿¼ë¦¬)

### Part 2: ê³ ê¸‰ ì‹¤ìŠµ (11-20ë²ˆ)
- [Jobê³¼ CronJob ê´€ë¦¬](#ë¬¸ì œ-11-jobê³¼-cronjob-ê´€ë¦¬)
- [DaemonSetê³¼ ë…¸ë“œ ê´€ë¦¬](#ë¬¸ì œ-12-daemonsetê³¼-ë…¸ë“œ-ê´€ë¦¬)
- [Multi-Container Pod](#ë¬¸ì œ-13-multi-container-pod)
- [ë³µì¡í•œ ì• í”Œë¦¬ì¼€ì´ì…˜ ë””ë²„ê¹…](#ë¬¸ì œ-14-ë³µì¡í•œ-ì• í”Œë¦¬ì¼€ì´ì…˜-ë””ë²„ê¹…)
- [í´ëŸ¬ìŠ¤í„° ì„±ëŠ¥ ìµœì í™”](#ë¬¸ì œ-15-í´ëŸ¬ìŠ¤í„°-ì„±ëŠ¥-ìµœì í™”)
- [ì„œë¹„ìŠ¤ ë©”ì‹œ ë° ë¡œë“œ ë°¸ëŸ°ì‹±](#ë¬¸ì œ-16-ì„œë¹„ìŠ¤-ë©”ì‹œ-ë°-ë¡œë“œ-ë°¸ëŸ°ì‹±)
- [ë©€í‹° í…Œë„ŒíŠ¸ ë³´ì•ˆ êµ¬ì„±](#ë¬¸ì œ-17-ë©€í‹°-í…Œë„ŒíŠ¸-ë³´ì•ˆ-êµ¬ì„±)
- [ì¸ì¦ì„œ ê´€ë¦¬ ë° TLS êµ¬ì„±](#ë¬¸ì œ-18-ì¸ì¦ì„œ-ê´€ë¦¬-ë°-tls-êµ¬ì„±)
- [í´ëŸ¬ìŠ¤í„° ë°±ì—… ë° ì¬í•´ ë³µêµ¬](#ë¬¸ì œ-19-í´ëŸ¬ìŠ¤í„°-ë°±ì—…-ë°-ì¬í•´-ë³µêµ¬)
- [ëª¨ë‹ˆí„°ë§ ë° ë¡œê¹… êµ¬ì„±](#ë¬¸ì œ-20-ëª¨ë‹ˆí„°ë§-ë°-ë¡œê¹…-êµ¬ì„±)

---

## Part 1: ê¸°ë³¸ ì‹¤ìŠµ

### ë¬¸ì œ 1: CNI ì„¤ì¹˜

#### ğŸ“‹ ë¬¸ì œ
NetworkPolicy ì§€ì›ì´ í•„ìš”í•œ CNIë¥¼ ì„¤ì¹˜í•˜ì„¸ìš”. Calicoì™€ Flannel ì¤‘ ì ì ˆí•œ ê²ƒì„ ì„ íƒí•˜ì—¬ ì„¤ì¹˜í•˜ê³  Pod ê°„ í†µì‹ ì„ í…ŒìŠ¤íŠ¸í•˜ì„¸ìš”.

**ìš”êµ¬ì‚¬í•­:**
- NetworkPolicy ì§€ì› í•„ìˆ˜
- Pod ê°„ í†µì‹  ê°€ëŠ¥
- ë§¤ë‹ˆí˜ìŠ¤íŠ¸ íŒŒì¼ ì‚¬ìš© (Helm ì‚¬ìš© ê¸ˆì§€)

#### ğŸ› ï¸ í™˜ê²½ ì„¤ì • (KillerCodaì—ì„œ ì‹¤í–‰)

```bash
# ê¸°ì¡´ CNI ì œê±° (ìˆë‹¤ë©´)
kubectl delete -f https://github.com/flannel-io/flannel/releases/download/v0.26.1/kube-flannel.yml --ignore-not-found

# ë…¸ë“œ ìƒíƒœ í™•ì¸ (CNI ì—†ìœ¼ë©´ NotReady)
kubectl get nodes

echo "CNIê°€ ì œê±°ë˜ì—ˆìŠµë‹ˆë‹¤. NetworkPolicyë¥¼ ì§€ì›í•˜ëŠ” CNIë¥¼ ì„¤ì¹˜í•˜ì„¸ìš”."
```

#### âœ… ì†”ë£¨ì…˜

```bash
# 1. NetworkPolicy ì§€ì› ì—¬ë¶€ í™•ì¸
# Calico: ì§€ì› O, Flannel: ì§€ì› X
# ë”°ë¼ì„œ Calico ì„ íƒ

# 2. Calico ì„¤ì¹˜ (create ì‚¬ìš©!)
kubectl create -f https://raw.githubusercontent.com/projectcalico/calico/v3.29.2/manifests/tigera-operator.yaml

# 3. Calico ì„¤ì¹˜ í™•ì¸
kubectl get pods -n calico-system
kubectl get pods -n tigera-operator

# 4. ë…¸ë“œ ìƒíƒœ í™•ì¸
kubectl get nodes

# 5. í…ŒìŠ¤íŠ¸ Pod ìƒì„±
kubectl run test1 --image=busybox:1.35 --restart=Never -- sleep 3600
kubectl run test2 --image=busybox:1.35 --restart=Never -- sleep 3600

# 6. Pod ê°„ í†µì‹  í…ŒìŠ¤íŠ¸
kubectl exec test1 -- ping -c 4 $(kubectl get pod test2 -o jsonpath='{.status.podIP}')

# 7. NetworkPolicy í…ŒìŠ¤íŠ¸
cat <<EOF | kubectl apply -f -
apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  name: test-netpol
spec:
  podSelector:
    matchLabels:
      run: test2
  policyTypes:
  - Ingress
  ingress: []  # ëª¨ë“  íŠ¸ë˜í”½ ì°¨ë‹¨
EOF

# 8. ì°¨ë‹¨ëœ í†µì‹  í…ŒìŠ¤íŠ¸ (ì‹¤íŒ¨í•´ì•¼ í•¨)
kubectl exec test1 -- ping -c 2 $(kubectl get pod test2 -o jsonpath='{.status.podIP}') || echo "Traffic blocked by NetworkPolicy (expected)"

# 9. ì •ë¦¬
kubectl delete networkpolicy test-netpol
kubectl delete pod test1 test2

echo "Calico CNI ì„¤ì¹˜ ë° NetworkPolicy í…ŒìŠ¤íŠ¸ ì™„ë£Œ"
```

---

### ë¬¸ì œ 2: Helm í…œí”Œë¦¿ ìƒì„±

#### ğŸ“‹ ë¬¸ì œ
ArgoCD Helm Chartì˜ í…œí”Œë¦¿ì„ ìƒì„±í•˜ì„¸ìš”. CRD ì„¤ì¹˜ëŠ” ë¹„í™œì„±í™”í•˜ê³  í…œí”Œë¦¿ì„ íŒŒì¼ë¡œ ì €ì¥í•˜ì„¸ìš”.

**ìš”êµ¬ì‚¬í•­:**
- Chart ë²„ì „: 7.7.3
- Namespace: argocd
- CRD ì„¤ì¹˜ ë¹„í™œì„±í™”
- í…œí”Œë¦¿ì„ ~/argo-helm.yamlë¡œ ì €ì¥

#### ğŸ› ï¸ í™˜ê²½ ì„¤ì • (KillerCodaì—ì„œ ì‹¤í–‰)

```bash
# Helm ì„¤ì¹˜ í™•ì¸
helm version

# ArgoCD CRDê°€ ì´ë¯¸ ì„¤ì¹˜ë˜ì–´ ìˆë‹¤ê³  ê°€ì •
kubectl apply -f https://raw.githubusercontent.com/argoproj/argo-cd/stable/manifests/crds/application-crd.yaml
kubectl apply -f https://raw.githubusercontent.com/argoproj/argo-cd/stable/manifests/crds/applicationset-crd.yaml

echo "ArgoCD CRDê°€ ì„¤ì¹˜ë˜ì—ˆìŠµë‹ˆë‹¤. Helm í…œí”Œë¦¿ì„ ìƒì„±í•˜ì„¸ìš”."
```

#### âœ… ì†”ë£¨ì…˜

```bash
# 1. Helm repository ì¶”ê°€
helm repo add argo https://argoproj.github.io/argo-helm
helm repo update

# 2. ì‚¬ìš© ê°€ëŠ¥í•œ ì°¨íŠ¸ ë²„ì „ í™•ì¸
helm search repo argo/argo-cd --versions | head -10

# 3. í…œí”Œë¦¿ ìƒì„± (CRD ì„¤ì¹˜ ë¹„í™œì„±í™”)
helm template argocd argo/argo-cd --version 7.7.3 -n argocd \
  --set crds.install=false > ~/argo-helm.yaml

# 4. ìƒì„±ëœ í…œí”Œë¦¿ í™•ì¸
ls -la ~/argo-helm.yaml
head -20 ~/argo-helm.yaml

# 5. í…œí”Œë¦¿ ë‚´ìš© ê²€ì¦
grep -c "kind:" ~/argo-helm.yaml
grep "CustomResourceDefinition" ~/argo-helm.yaml || echo "No CRDs found (expected)"

# 6. ë„¤ì„ìŠ¤í˜ì´ìŠ¤ ìƒì„± í›„ ì ìš© í…ŒìŠ¤íŠ¸ (ì„ íƒì‚¬í•­)
kubectl create namespace argocd
kubectl apply -f ~/argo-helm.yaml

# 7. ì„¤ì¹˜ëœ ë¦¬ì†ŒìŠ¤ í™•ì¸
kubectl get all -n argocd

echo "Helm í…œí”Œë¦¿ ìƒì„± ì™„ë£Œ: ~/argo-helm.yaml"
```

---

### ë¬¸ì œ 3: HPA êµ¬ì„±

#### ğŸ“‹ ë¬¸ì œ
Horizontal Pod Autoscalerë¥¼ êµ¬ì„±í•˜ì—¬ CPU ì‚¬ìš©ëŸ‰ì— ë”°ë¼ ìë™ìœ¼ë¡œ Pod ìˆ˜ë¥¼ ì¡°ì ˆí•˜ì„¸ìš”.

**ìš”êµ¬ì‚¬í•­:**
- CPU ì‚¬ìš©ë¥  70% ê¸°ì¤€
- ìµœì†Œ 2ê°œ, ìµœëŒ€ 10ê°œ Pod
- ìŠ¤ì¼€ì¼ ë‹¤ìš´ ì•ˆì •í™” ì‹œê°„ 300ì´ˆ
- ë¶€í•˜ í…ŒìŠ¤íŠ¸ë¡œ ë™ì‘ í™•ì¸

#### ğŸ› ï¸ í™˜ê²½ ì„¤ì • (KillerCodaì—ì„œ ì‹¤í–‰)

```bash
# HPA í…ŒìŠ¤íŠ¸ ë„¤ì„ìŠ¤í˜ì´ìŠ¤ ìƒì„±
kubectl create namespace hpa-test

# Metrics Server ì„¤ì¹˜ (HPA ë™ì‘ì„ ìœ„í•´ í•„ìš”)
kubectl apply -f https://github.com/kubernetes-sigs/metrics-server/releases/latest/download/components.yaml

# Metrics Server ì„¤ì • ìˆ˜ì • (KillerCoda í™˜ê²½ìš©)
kubectl patch deployment metrics-server -n kube-system --type='json' \
  -p='[{"op": "add", "path": "/spec/template/spec/containers/0/args/-", "value": "--kubelet-insecure-tls"}]'

echo "HPA í…ŒìŠ¤íŠ¸ í™˜ê²½ì´ ì„¤ì •ë˜ì—ˆìŠµë‹ˆë‹¤. Metrics Serverê°€ ì¤€ë¹„ë  ë•Œê¹Œì§€ ì ì‹œ ê¸°ë‹¤ë¦¬ì„¸ìš”."
```

#### âœ… ì†”ë£¨ì…˜

```bash
# 1. í…ŒìŠ¤íŠ¸ ì• í”Œë¦¬ì¼€ì´ì…˜ ë°°í¬
cat <<EOF | kubectl apply -f -
apiVersion: apps/v1
kind: Deployment
metadata:
  name: web-app
  namespace: hpa-test
spec:
  replicas: 2
  selector:
    matchLabels:
      app: web-app
  template:
    metadata:
      labels:
        app: web-app
    spec:
      containers:
      - name: web
        image: nginx:1.21
        resources:
          requests:
            cpu: 100m
            memory: 128Mi
          limits:
            cpu: 500m
            memory: 512Mi
        ports:
        - containerPort: 80
EOF

# 2. ì„œë¹„ìŠ¤ ìƒì„±
kubectl expose deployment web-app --name=web-app-service --port=80 -n hpa-test

# 3. HPA ìƒì„±
cat <<EOF | kubectl apply -f -
apiVersion: autoscaling/v2
kind: HorizontalPodAutoscaler
metadata:
  name: web-app-hpa
  namespace: hpa-test
spec:
  scaleTargetRef:
    apiVersion: apps/v1
    kind: Deployment
    name: web-app
  minReplicas: 2
  maxReplicas: 10
  metrics:
  - type: Resource
    resource:
      name: cpu
      target:
        type: Utilization
        averageUtilization: 70
  behavior:
    scaleDown:
      stabilizationWindowSeconds: 300
      policies:
      - type: Percent
        value: 50
        periodSeconds: 60
    scaleUp:
      stabilizationWindowSeconds: 60
      policies:
      - type: Percent
        value: 100
        periodSeconds: 60
EOF

# 4. HPA ìƒíƒœ í™•ì¸
kubectl get hpa -n hpa-test
kubectl describe hpa web-app-hpa -n hpa-test

# 5. ë¶€í•˜ í…ŒìŠ¤íŠ¸ ì‹¤í–‰
kubectl run load-generator --image=busybox:1.35 -n hpa-test --rm -it --restart=Never -- sh -c "
while true; do
  wget -q -O- http://web-app-service.hpa-test.svc.cluster.local
  sleep 0.01
done
" &

# 6. HPA ë™ì‘ ëª¨ë‹ˆí„°ë§
kubectl get hpa -n hpa-test -w &
sleep 120

# 7. ìŠ¤ì¼€ì¼ë§ ê²°ê³¼ í™•ì¸
kubectl get pods -n hpa-test
kubectl get hpa -n hpa-test

# 8. ë¶€í•˜ í…ŒìŠ¤íŠ¸ ì¤‘ì§€
pkill -f "wget.*web-app-service"

echo "HPA êµ¬ì„± ë° í…ŒìŠ¤íŠ¸ ì™„ë£Œ"
```

---

### ë¬¸ì œ 4: Sidecar ì»¨í…Œì´ë„ˆ

#### ğŸ“‹ ë¬¸ì œ
ê¸°ì¡´ deploymentì— ë¡œê·¸ ìˆ˜ì§‘ìš© sidecar ì»¨í…Œì´ë„ˆë¥¼ ì¶”ê°€í•˜ì„¸ìš”.

**ìš”êµ¬ì‚¬í•­:**
- ë©”ì¸ ì»¨í…Œì´ë„ˆ: nginx
- Sidecar ì»¨í…Œì´ë„ˆ: busybox (ë¡œê·¸ íŒŒì¼ tail)
- ê³µìœ  ë³¼ë¥¨ì„ í†µí•œ ë¡œê·¸ íŒŒì¼ ê³µìœ 
- Sidecarì—ì„œ ë¡œê·¸ ì¶œë ¥ í™•ì¸

#### ğŸ› ï¸ í™˜ê²½ ì„¤ì • (KillerCodaì—ì„œ ì‹¤í–‰)

```bash
# Sidecar í…ŒìŠ¤íŠ¸ ë„¤ì„ìŠ¤í˜ì´ìŠ¤ ìƒì„±
kubectl create namespace sidecar-test

echo "Sidecar í…ŒìŠ¤íŠ¸ í™˜ê²½ì´ ì„¤ì •ë˜ì—ˆìŠµë‹ˆë‹¤."
```

#### âœ… ì†”ë£¨ì…˜

```bash
# 1. Sidecarê°€ í¬í•¨ëœ deployment ìƒì„±
cat <<EOF | kubectl apply -f -
apiVersion: apps/v1
kind: Deployment
metadata:
  name: app-server
  namespace: sidecar-test
spec:
  replicas: 1
  selector:
    matchLabels:
      app: app-server
  template:
    metadata:
      labels:
        app: app-server
    spec:
      containers:
      - name: app
        image: nginx:1.21
        ports:
        - containerPort: 80
        command:
        - sh
        - -c
        - |
          # ë¡œê·¸ íŒŒì¼ ìƒì„± ë° nginx ì‹œì‘
          touch /var/log/app.log
          while true; do
            echo "\$(date): Application log entry" >> /var/log/app.log
            sleep 5
          done &
          nginx -g 'daemon off;'
        volumeMounts:
        - name: log-volume
          mountPath: /var/log
      - name: log-sidecar
        image: busybox:1.35
        command:
        - sh
        - -c
        - |
          # ë¡œê·¸ íŒŒì¼ì´ ìƒì„±ë  ë•Œê¹Œì§€ ëŒ€ê¸°
          while [ ! -f /var/log/app.log ]; do
            echo "Waiting for log file..."
            sleep 2
          done
          echo "Starting log collection..."
          tail -f /var/log/app.log
        volumeMounts:
        - name: log-volume
          mountPath: /var/log
      volumes:
      - name: log-volume
        emptyDir: {}
EOF

# 2. Pod ìƒíƒœ í™•ì¸
kubectl get pods -n sidecar-test

# 3. Sidecar ì»¨í…Œì´ë„ˆ ë¡œê·¸ í™•ì¸
kubectl logs -n sidecar-test -l app=app-server -c log-sidecar -f &
sleep 30

# 4. Pod ë‚´ë¶€ì—ì„œ ë¡œê·¸ íŒŒì¼ í™•ì¸
kubectl exec -n sidecar-test deployment/app-server -c app -- ls -la /var/log/
kubectl exec -n sidecar-test deployment/app-server -c app -- tail -5 /var/log/app.log

echo "SideCar ì»¨í…Œì´ë„ˆ êµ¬ì„± ì™„ë£Œ"
```

---

### ë¬¸ì œ 5: PriorityClass êµ¬ì„±

#### ğŸ“‹ ë¬¸ì œ
ë†’ì€ ìš°ì„ ìˆœìœ„ë¥¼ ê°€ì§„ PriorityClassë¥¼ ìƒì„±í•˜ê³ , ê¸°ì¡´ deploymentì— ì ìš©í•˜ì—¬ ë¦¬ì†ŒìŠ¤ ë¶€ì¡± ì‹œ ìš°ì„  ìŠ¤ì¼€ì¤„ë§ë˜ë„ë¡ ì„¤ì •í•˜ì„¸ìš”.

**ìš”êµ¬ì‚¬í•­:**
- PriorityClass ì´ë¦„: high-priority
- ìš°ì„ ìˆœìœ„ ê°’: 1000
- ê¸°ì¡´ deploymentì— ì ìš©
- ìš°ì„ ìˆœìœ„ ë™ì‘ í™•ì¸

#### ğŸ› ï¸ í™˜ê²½ ì„¤ì • (KillerCodaì—ì„œ ì‹¤í–‰)

```bash
# ë„¤ì„ìŠ¤í˜ì´ìŠ¤ ìƒì„±
kubectl create namespace priority-test

# í…ŒìŠ¤íŠ¸ìš© deployment ìƒì„±
kubectl create deployment test-app --image=nginx:1.21 --replicas=2 -n priority-test

echo "ìš°ì„ ìˆœìœ„ í…ŒìŠ¤íŠ¸ í™˜ê²½ì´ ì„¤ì •ë˜ì—ˆìŠµë‹ˆë‹¤."
```

#### âœ… ì†”ë£¨ì…˜

```bash
# 1. ë†’ì€ ìš°ì„ ìˆœìœ„ í´ë˜ìŠ¤ ìƒì„±
kubectl create priorityclass high-priority --value=1000 --description="High priority class for critical workloads"

# 2. PriorityClass í™•ì¸
kubectl describe priorityclass high-priority

# 3. Deploymentì— ìš°ì„ ìˆœìœ„ ì ìš©
kubectl patch deployment test-app -n priority-test -p '{"spec":{"template":{"spec":{"priorityClassName":"high-priority"}}}}'

# 4. ìš°ì„ ìˆœìœ„ ì ìš© í™•ì¸
kubectl get pods -n priority-test -o custom-columns=NAME:.metadata.name,PRIORITY:.spec.priorityClassName,STATUS:.status.phase

# 5. Pod ìƒì„¸ ì •ë³´ì—ì„œ ìš°ì„ ìˆœìœ„ í™•ì¸
kubectl describe pod -n priority-test -l app=test-app | grep -A 5 "Priority"

echo "PriorityClass êµ¬ì„± ì™„ë£Œ"
```

---

### ë¬¸ì œ 6: Pod Security Admission

#### ğŸ“‹ ë¬¸ì œ
ë„¤ì„ìŠ¤í˜ì´ìŠ¤ì— Pod Security Standardsë¥¼ ì ìš©í•˜ì—¬ ë³´ì•ˆ ì •ì±…ì„ ê°•í™”í•˜ì„¸ìš”.

**ìš”êµ¬ì‚¬í•­:**
- restricted ì •ì±…ì„ enforce ëª¨ë“œë¡œ ì ìš©
- ì •ì±… ìœ„ë°˜ Pod ìƒì„± ì‹œë„
- ì •ì±…ì„ ì¤€ìˆ˜í•˜ëŠ” ë³´ì•ˆ Pod ìƒì„±

#### ğŸ› ï¸ í™˜ê²½ ì„¤ì • (KillerCodaì—ì„œ ì‹¤í–‰)

```bash
# ë³´ì•ˆ í…ŒìŠ¤íŠ¸ ë„¤ì„ìŠ¤í˜ì´ìŠ¤ ìƒì„±
kubectl create namespace security-test

echo "ë³´ì•ˆ í…ŒìŠ¤íŠ¸ í™˜ê²½ì´ ì„¤ì •ë˜ì—ˆìŠµë‹ˆë‹¤."
```

#### âœ… ì†”ë£¨ì…˜

```bash
# 1. Pod Security Standards ì ìš©
kubectl label namespace security-test \
  pod-security.kubernetes.io/enforce=restricted \
  pod-security.kubernetes.io/enforce-version=latest \
  pod-security.kubernetes.io/audit=restricted \
  pod-security.kubernetes.io/audit-version=latest \
  pod-security.kubernetes.io/warn=restricted \
  pod-security.kubernetes.io/warn-version=latest

# 2. ë„¤ì„ìŠ¤í˜ì´ìŠ¤ ë¼ë²¨ í™•ì¸
kubectl get namespace security-test --show-labels

# 3. ì •ì±… ìœ„ë°˜ Pod ìƒì„± ì‹œë„ (ì‹¤íŒ¨í•´ì•¼ í•¨)
cat <<EOF | kubectl apply -f -
apiVersion: v1
kind: Pod
metadata:
  name: privileged-pod
  namespace: security-test
spec:
  containers:
  - name: nginx
    image: nginx:1.21
    securityContext:
      privileged: true  # ì´ê²ƒì€ ê±°ë¶€ë˜ì–´ì•¼ í•¨
EOF

# 4. ì •ì±…ì„ ì¤€ìˆ˜í•˜ëŠ” ë³´ì•ˆ Pod ìƒì„±
cat <<EOF | kubectl apply -f -
apiVersion: v1
kind: Pod
metadata:
  name: secure-pod
  namespace: security-test
spec:
  securityContext:
    runAsNonRoot: true
    runAsUser: 1000
    runAsGroup: 3000
    fsGroup: 2000
    seccompProfile:
      type: RuntimeDefault
  containers:
  - name: nginx
    image: nginx:1.21
    securityContext:
      allowPrivilegeEscalation: false
      readOnlyRootFilesystem: true
      runAsNonRoot: true
      runAsUser: 1000
      capabilities:
        drop:
        - ALL
    resources:
      requests:
        cpu: 100m
        memory: 128Mi
      limits:
        cpu: 200m
        memory: 256Mi
    volumeMounts:
    - name: tmp
      mountPath: /tmp
    - name: var-cache
      mountPath: /var/cache/nginx
    - name: var-run
      mountPath: /var/run
  volumes:
  - name: tmp
    emptyDir: {}
  - name: var-cache
    emptyDir: {}
  - name: var-run
    emptyDir: {}
EOF

# 5. Pod ìƒíƒœ í™•ì¸
kubectl get pods -n security-test

# 6. ë³´ì•ˆ ì»¨í…ìŠ¤íŠ¸ í™•ì¸
kubectl describe pod secure-pod -n security-test | grep -A 20 "Security Context"

echo "Pod Security Admission êµ¬ì„± ì™„ë£Œ"
```

---

### ë¬¸ì œ 7: Taintì™€ Toleration

#### ğŸ“‹ ë¬¸ì œ
ë…¸ë“œì— taintë¥¼ ì„¤ì •í•˜ê³ , íŠ¹ì • Podë§Œ í•´ë‹¹ ë…¸ë“œì— ìŠ¤ì¼€ì¤„ë  ìˆ˜ ìˆë„ë¡ tolerationì„ êµ¬ì„±í•˜ì„¸ìš”.

**ìš”êµ¬ì‚¬í•­:**
- ë…¸ë“œì— maintenance taint ì„¤ì •
- Tolerationì´ ìˆëŠ” Podì™€ ì—†ëŠ” Pod ìƒì„±
- ìŠ¤ì¼€ì¤„ë§ ë™ì‘ í™•ì¸

#### ğŸ› ï¸ í™˜ê²½ ì„¤ì • (KillerCodaì—ì„œ ì‹¤í–‰)

```bash
# í…ŒìŠ¤íŠ¸ ë„¤ì„ìŠ¤í˜ì´ìŠ¤ ìƒì„±
kubectl create namespace taint-test

# í˜„ì¬ ë…¸ë“œ ìƒíƒœ í™•ì¸
kubectl get nodes
kubectl describe nodes | grep -i taint

echo "Taintì™€ Toleration í…ŒìŠ¤íŠ¸ í™˜ê²½ì´ ì„¤ì •ë˜ì—ˆìŠµë‹ˆë‹¤."
```

#### âœ… ì†”ë£¨ì…˜

```bash
# 1. ë…¸ë“œì— taint ì„¤ì •
NODE_NAME=$(kubectl get nodes -o jsonpath='{.items[0].metadata.name}')
kubectl taint node $NODE_NAME maintenance=true:NoSchedule

# 2. Taint ì„¤ì • í™•ì¸
kubectl describe node $NODE_NAME | grep -i taint

# 3. Toleration ì—†ëŠ” Pod ìƒì„± (ìŠ¤ì¼€ì¤„ë§ ì‹¤íŒ¨í•´ì•¼ í•¨)
kubectl run no-toleration-pod --image=nginx:1.21 -n taint-test

# 4. Pod ìƒíƒœ í™•ì¸ (Pending ìƒíƒœì—¬ì•¼ í•¨)
kubectl get pods -n taint-test
kubectl describe pod no-toleration-pod -n taint-test | grep -A 5 Events

# 5. Tolerationì´ ìˆëŠ” Pod ìƒì„±
cat <<EOF | kubectl apply -f -
apiVersion: v1
kind: Pod
metadata:
  name: toleration-pod
  namespace: taint-test
spec:
  tolerations:
  - key: "maintenance"
    operator: "Equal"
    value: "true"
    effect: "NoSchedule"
  containers:
  - name: nginx
    image: nginx:1.21
    resources:
      requests:
        cpu: 100m
        memory: 128Mi
EOF

# 6. Toleration Pod ìƒíƒœ í™•ì¸ (Running ìƒíƒœì—¬ì•¼ í•¨)
kubectl get pods -n taint-test -o wide

# 7. Taint ì œê±°
kubectl taint node $NODE_NAME maintenance-

# 8. ì´ì „ì— Pendingì´ë˜ Pod ìƒíƒœ í™•ì¸
kubectl get pods -n taint-test -o wide

echo "Taintì™€ Toleration êµ¬ì„± ì™„ë£Œ"
```

---

### ë¬¸ì œ 8: NetworkPolicy êµ¬í˜„

#### ğŸ“‹ ë¬¸ì œ
3ê³„ì¸µ ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ìœ„í•œ NetworkPolicyë¥¼ êµ¬í˜„í•˜ì„¸ìš”.

**ìš”êµ¬ì‚¬í•­:**
- ì›¹, ì•±, ë°ì´í„°ë² ì´ìŠ¤ ê³„ì¸µ ë¶„ë¦¬
- ê³„ì¸µ ê°„ í†µì‹ ë§Œ í—ˆìš©
- ì™¸ë¶€ì—ì„œ ì›¹ ê³„ì¸µë§Œ ì ‘ê·¼ ê°€ëŠ¥

#### ğŸ› ï¸ í™˜ê²½ ì„¤ì • (KillerCodaì—ì„œ ì‹¤í–‰)

```bash
kubectl create namespace web-tier
kubectl create namespace app-tier  
kubectl create namespace db-tier

kubectl label namespace web-tier name=web-tier
kubectl label namespace app-tier name=app-tier
kubectl label namespace db-tier name=db-tier

echo "3ê³„ì¸µ ì• í”Œë¦¬ì¼€ì´ì…˜ í™˜ê²½ì´ ì„¤ì •ë˜ì—ˆìŠµë‹ˆë‹¤."
```

#### âœ… ì†”ë£¨ì…˜

```bash
# 1. Web tier policy
cat <<EOF | kubectl apply -f -
apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  name: web-tier-policy
  namespace: web-tier
spec:
  podSelector: {}
  policyTypes:
  - Ingress
  - Egress
  ingress:
  - ports:
    - protocol: TCP
      port: 80
  egress:
  - to:
    - namespaceSelector:
        matchLabels:
          name: app-tier
    ports:
    - protocol: TCP
      port: 8080
EOF

# 2. App tier policy  
cat <<EOF | kubectl apply -f -
apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  name: app-tier-policy
  namespace: app-tier
spec:
  podSelector: {}
  policyTypes:
  - Ingress
  - Egress
  ingress:
  - from:
    - namespaceSelector:
        matchLabels:
          name: web-tier
    ports:
    - protocol: TCP
      port: 8080
  egress:
  - to:
    - namespaceSelector:
        matchLabels:
          name: db-tier
    ports:
    - protocol: TCP
      port: 5432
EOF

# 3. DB tier policy
cat <<EOF | kubectl apply -f -
apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  name: db-tier-policy
  namespace: db-tier
spec:
  podSelector: {}
  policyTypes:
  - Ingress
  ingress:
  - from:
    - namespaceSelector:
        matchLabels:
          name: app-tier
    ports:
    - protocol: TCP
      port: 5432
EOF

# 4. í…ŒìŠ¤íŠ¸ ì• í”Œë¦¬ì¼€ì´ì…˜ ë°°í¬
kubectl create deployment web-app --image=nginx:1.21 -n web-tier
kubectl create deployment app-server --image=nginx:1.21 -n app-tier
kubectl create deployment database --image=postgres:13 --env="POSTGRES_PASSWORD=secret" -n db-tier

# 5. NetworkPolicy í™•ì¸
kubectl get networkpolicy -A

echo "NetworkPolicy êµ¬í˜„ ì™„ë£Œ"
```

---

### ë¬¸ì œ 9: StorageClass êµ¬ì„±

#### ğŸ“‹ ë¬¸ì œ
ì‚¬ìš©ì ì •ì˜ StorageClassë¥¼ ìƒì„±í•˜ê³  ê¸°ë³¸ StorageClassë¡œ ì„¤ì •í•˜ì„¸ìš”.

**ìš”êµ¬ì‚¬í•­:**
- StorageClass ì´ë¦„: fast-ssd
- ê¸°ë³¸ StorageClassë¡œ ì„¤ì •
- Volume í™•ì¥ í—ˆìš©
- WaitForFirstConsumer ë°”ì¸ë”© ëª¨ë“œ

#### ğŸ› ï¸ í™˜ê²½ ì„¤ì • (KillerCodaì—ì„œ ì‹¤í–‰)

```bash
# ê¸°ì¡´ StorageClass í™•ì¸
kubectl get storageclass

echo "StorageClass í…ŒìŠ¤íŠ¸ í™˜ê²½ì´ ì„¤ì •ë˜ì—ˆìŠµë‹ˆë‹¤."
```

#### âœ… ì†”ë£¨ì…˜

```bash
# 1. ê¸°ì¡´ ê¸°ë³¸ StorageClass ì œê±° (ìˆë‹¤ë©´)
kubectl patch storageclass standard -p '{"metadata": {"annotations":{"storageclass.kubernetes.io/is-default-class":"false"}}}' || true

# 2. ìƒˆ StorageClass ìƒì„±
cat <<EOF | kubectl apply -f -
apiVersion: storage.k8s.io/v1
kind: StorageClass
metadata:
  name: fast-ssd
  annotations:
    storageclass.kubernetes.io/is-default-class: "true"
provisioner: k8s.io/minikube-hostpath
parameters:
  type: "fast"
allowVolumeExpansion: true
volumeBindingMode: WaitForFirstConsumer
EOF

# 3. StorageClass í™•ì¸
kubectl get storageclass
kubectl describe storageclass fast-ssd

# 4. í…ŒìŠ¤íŠ¸ PVC ìƒì„±
cat <<EOF | kubectl apply -f -
apiVersion: v1
kind: PersistentVolumeClaim
metadata:
  name: test-pvc
spec:
  accessModes:
  - ReadWriteOnce
  resources:
    requests:
      storage: 1Gi
EOF

# 5. PVC ìƒíƒœ í™•ì¸
kubectl get pvc test-pvc

echo "StorageClass êµ¬ì„± ì™„ë£Œ"
```

---

### ë¬¸ì œ 10: JSONPath ì¿¼ë¦¬

#### ğŸ“‹ ë¬¸ì œ
JSONPathë¥¼ ì‚¬ìš©í•˜ì—¬ í´ëŸ¬ìŠ¤í„° ì •ë³´ë¥¼ ì¶”ì¶œí•˜ê³  íŒŒì¼ë¡œ ì €ì¥í•˜ì„¸ìš”.

**ìš”êµ¬ì‚¬í•­:**
- ë…¸ë“œ OS ì •ë³´ ì¶”ì¶œ
- Pod IP ì£¼ì†Œ ëª©ë¡
- íŠ¹ì • í•„ë“œë¡œ ì •ë ¬
- ê²°ê³¼ë¥¼ íŒŒì¼ë¡œ ì €ì¥

#### ğŸ› ï¸ í™˜ê²½ ì„¤ì • (KillerCodaì—ì„œ ì‹¤í–‰)

```bash
# í…ŒìŠ¤íŠ¸ìš© Pod ìƒì„±
kubectl run test-pod1 --image=nginx:1.21
kubectl run test-pod2 --image=busybox:1.35 -- sleep 3600
kubectl run test-pod3 --image=redis:6-alpine

echo "JSONPath í…ŒìŠ¤íŠ¸ í™˜ê²½ì´ ì„¤ì •ë˜ì—ˆìŠµë‹ˆë‹¤."
```

#### âœ… ì†”ë£¨ì…˜

```bash
# 1. ë…¸ë“œ OS ì •ë³´ ì¶”ì¶œ
kubectl get nodes -o jsonpath='{range .items[*]}{.metadata.name}{"\t"}{.status.nodeInfo.osImage}{"\n"}{end}' > /tmp/node-os-info.txt

# 2. Pod IP ì¶”ì¶œ
kubectl get pods -o jsonpath='{.items[*].status.podIP}' > /tmp/pod-ips.txt

# 3. Pod ì´ë¦„ê³¼ ìƒíƒœ ì¶”ì¶œ
kubectl get pods -o jsonpath='{range .items[*]}{.metadata.name}{"\t"}{.status.phase}{"\t"}{.spec.nodeName}{"\n"}{end}' > /tmp/pod-status.txt

# 4. íŠ¹ì • í•„ë“œë¡œ ì •ë ¬
kubectl get pods --sort-by='.metadata.creationTimestamp' -o jsonpath='{range .items[*]}{.metadata.name}{"\t"}{.metadata.creationTimestamp}{"\n"}{end}' > /tmp/pods-by-time.txt

# 5. ë³µì¡í•œ JSONPath ì¿¼ë¦¬ - ë¦¬ì†ŒìŠ¤ ìš”ì²­ëŸ‰
kubectl get pods -o jsonpath='{range .items[*]}{.metadata.name}{"\t"}{.spec.containers[0].resources.requests.cpu}{"\t"}{.spec.containers[0].resources.requests.memory}{"\n"}{end}' > /tmp/pod-resources.txt

# 6. ê²°ê³¼ íŒŒì¼ í™•ì¸
echo "=== Node OS Info ==="
cat /tmp/node-os-info.txt

echo "=== Pod IPs ==="
cat /tmp/pod-ips.txt

echo "=== Pod Status ==="
cat /tmp/pod-status.txt

echo "=== Pods by Creation Time ==="
cat /tmp/pods-by-time.txt

echo "=== Pod Resources ==="
cat /tmp/pod-resources.txt

# 7. íŒŒì¼ ëª©ë¡ í™•ì¸
ls -la /tmp/*.txt

echo "JSONPath ì¿¼ë¦¬ ì™„ë£Œ"
```

---

## ğŸ¯ Part 1 ì™„ë£Œ ì²´í¬ë¦¬ìŠ¤íŠ¸

### âœ… ì™„ë£Œëœ ì£¼ìš” ì˜ì—­

1. **ë„¤íŠ¸ì›Œí‚¹** âœ…
   - CNI ì„¤ì¹˜ (Calico)
   - NetworkPolicy êµ¬í˜„

2. **ì›Œí¬ë¡œë“œ ê´€ë¦¬** âœ…
   - Helm í…œí”Œë¦¿ ìƒì„±
   - HPA êµ¬ì„±
   - Sidecar ì»¨í…Œì´ë„ˆ
   - PriorityClass êµ¬ì„±

3. **ë³´ì•ˆ** âœ…
   - Pod Security Admission
   - Taintì™€ Toleration

4. **ìŠ¤í† ë¦¬ì§€** âœ…
   - StorageClass êµ¬ì„±

5. **ìš´ì˜** âœ…
   - JSONPath ì¿¼ë¦¬

### ğŸš€ ë‹¤ìŒ ë‹¨ê³„

ì´ì œ **Part 2: ê³ ê¸‰ ì‹¤ìŠµ**ìœ¼ë¡œ ë„˜ì–´ê°€ì„œ ë” ë³µì¡í•œ ì‹œë‚˜ë¦¬ì˜¤ë¥¼ ì—°ìŠµí•˜ì„¸ìš”!

---

## Part 2: ê³ ê¸‰ ì‹¤ìŠµ

### ë¬¸ì œ 11: Jobê³¼ CronJob ê´€ë¦¬

#### ğŸ“‹ ë¬¸ì œ
ë³µì¡í•œ ë°°ì¹˜ ì²˜ë¦¬ ì›Œí¬í”Œë¡œìš°ë¥¼ Jobê³¼ CronJobìœ¼ë¡œ êµ¬í˜„í•˜ì„¸ìš”.

**ìš”êµ¬ì‚¬í•­:**
1. ë³‘ë ¬ ì²˜ë¦¬ Job ìƒì„± (5ê°œ ë³‘ë ¬, ì´ 20ê°œ ì™„ë£Œ)
2. ì¼ì¼ ë°±ì—…ìš© CronJob ì„¤ì •
3. Job ì‹¤íŒ¨ ì²˜ë¦¬ ë° ì¬ì‹œë„ ì •ì±… êµ¬í˜„
4. Job ì •ë¦¬ ì •ì±… ì„¤ì •

#### ğŸ› ï¸ í™˜ê²½ ì„¤ì • (KillerCodaì—ì„œ ì‹¤í–‰)

```bash
# ë„¤ì„ìŠ¤í˜ì´ìŠ¤ ìƒì„±
kubectl create namespace batch-processing

echo "ë°°ì¹˜ ì²˜ë¦¬ í™˜ê²½ì´ ì„¤ì •ë˜ì—ˆìŠµë‹ˆë‹¤."
```

#### âœ… ì†”ë£¨ì…˜

```bash
# 1. ë³‘ë ¬ ì²˜ë¦¬ Job ìƒì„±
cat <<EOF | kubectl apply -f -
apiVersion: batch/v1
kind: Job
metadata:
  name: data-processing-job
  namespace: batch-processing
spec:
  parallelism: 5
  completions: 20
  backoffLimit: 3
  activeDeadlineSeconds: 1800  # 30ë¶„
  ttlSecondsAfterFinished: 3600  # 1ì‹œê°„ í›„ ì •ë¦¬
  template:
    spec:
      restartPolicy: Never
      containers:
      - name: processor
        image: busybox:1.35
        command:
        - sh
        - -c
        - |
          echo "Processing batch \$HOSTNAME at \$(date)"
          # ëœë¤ ì²˜ë¦¬ ì‹œê°„ ì‹œë®¬ë ˆì´ì…˜
          sleep \$((RANDOM % 30 + 10))
          # 10% í™•ë¥ ë¡œ ì‹¤íŒ¨ ì‹œë®¬ë ˆì´ì…˜
          if [ \$((RANDOM % 10)) -eq 0 ]; then
            echo "Processing failed for \$HOSTNAME"
            exit 1
          fi
          echo "Batch \$HOSTNAME completed successfully at \$(date)"
        resources:
          requests:
            cpu: 100m
            memory: 128Mi
          limits:
            cpu: 200m
            memory: 256Mi
EOF

# 2. CronJob for ì¼ì¼ ë°±ì—… ìƒì„±
cat <<EOF | kubectl apply -f -
apiVersion: batch/v1
kind: CronJob
metadata:
  name: daily-backup
  namespace: batch-processing
spec:
  schedule: "0 2 * * *"  # ë§¤ì¼ ì˜¤ì „ 2ì‹œ
  timeZone: "UTC"
  successfulJobsHistoryLimit: 3
  failedJobsHistoryLimit: 1
  concurrencyPolicy: Forbid
  startingDeadlineSeconds: 300
  jobTemplate:
    spec:
      backoffLimit: 2
      activeDeadlineSeconds: 1800  # 30ë¶„
      template:
        spec:
          restartPolicy: OnFailure
          containers:
          - name: backup
            image: alpine:3.18
            command:
            - sh
            - -c
            - |
              echo "Starting backup at \$(date)"
              mkdir -p /backup/\$(date +%Y%m%d)
              echo "Backup data \$(date)" > /backup/\$(date +%Y%m%d)/backup.txt
              # ë°±ì—… í”„ë¡œì„¸ìŠ¤ ì‹œë®¬ë ˆì´ì…˜
              sleep 60
              echo "Backup completed successfully at \$(date)"
            env:
            - name: BACKUP_LOCATION
              value: "/backup"
            volumeMounts:
            - name: backup-storage
              mountPath: /backup
          volumes:
          - name: backup-storage
            emptyDir: {}
EOF

# 3. Job ìƒíƒœ ëª¨ë‹ˆí„°ë§
kubectl get jobs -n batch-processing
kubectl describe job data-processing-job -n batch-processing

# 4. CronJob ìƒíƒœ í™•ì¸
kubectl get cronjobs -n batch-processing
kubectl describe cronjob daily-backup -n batch-processing

# 5. ìˆ˜ë™ìœ¼ë¡œ CronJob ì‹¤í–‰ (í…ŒìŠ¤íŠ¸ìš©)
kubectl create job manual-backup --from=cronjob/daily-backup -n batch-processing

echo "Jobê³¼ CronJob ì„¤ì •ì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤."
```

---

### ë¬¸ì œ 12: DaemonSetê³¼ ë…¸ë“œ ê´€ë¦¬

#### ğŸ“‹ ë¬¸ì œ
ëª¨ë“  ë…¸ë“œì—ì„œ ì‹¤í–‰ë˜ëŠ” ë¡œê·¸ ìˆ˜ì§‘ DaemonSetì„ êµ¬ì„±í•˜ê³  ë…¸ë“œ ê´€ë¦¬ ì‘ì—…ì„ ìˆ˜í–‰í•˜ì„¸ìš”.

**ìš”êµ¬ì‚¬í•­:**
1. ë¡œê·¸ ìˆ˜ì§‘ìš© DaemonSet ìƒì„±
2. Control Plane ë…¸ë“œì—ì„œë„ ì‹¤í–‰ë˜ë„ë¡ toleration ì„¤ì •
3. ë…¸ë“œ ë“œë ˆì¸ ë° ì–¸ì½”ë“  ì‘ì—…
4. DaemonSet ì—…ë°ì´íŠ¸ ì „ëµ êµ¬í˜„

#### ğŸ› ï¸ í™˜ê²½ ì„¤ì • (KillerCodaì—ì„œ ì‹¤í–‰)

```bash
# ë„¤ì„ìŠ¤í˜ì´ìŠ¤ ìƒì„±
kubectl create namespace monitoring

echo "ëª¨ë‹ˆí„°ë§ í™˜ê²½ì´ ì„¤ì •ë˜ì—ˆìŠµë‹ˆë‹¤."
```

#### âœ… ì†”ë£¨ì…˜

```bash
# 1. ë¡œê·¸ ìˆ˜ì§‘ DaemonSet ìƒì„±
cat <<EOF | kubectl apply -f -
apiVersion: apps/v1
kind: DaemonSet
metadata:
  name: log-collector
  namespace: monitoring
  labels:
    app: log-collector
spec:
  selector:
    matchLabels:
      app: log-collector
  updateStrategy:
    type: RollingUpdate
    rollingUpdate:
      maxUnavailable: 1
  template:
    metadata:
      labels:
        app: log-collector
    spec:
      tolerations:
      - key: node-role.kubernetes.io/control-plane
        effect: NoSchedule
      - key: node-role.kubernetes.io/master
        effect: NoSchedule
      containers:
      - name: log-collector
        image: busybox:1.35
        command:
        - sh
        - -c
        - |
          while true; do
            echo "\$(date): Collecting logs from node \$(hostname)"
            # í˜¸ìŠ¤íŠ¸ì˜ ë¡œê·¸ íŒŒì¼ë“¤ì„ ëª¨ë‹ˆí„°ë§
            find /var/log -name "*.log" -type f 2>/dev/null | head -5
            sleep 30
          done
        resources:
          requests:
            cpu: 100m
            memory: 128Mi
          limits:
            cpu: 200m
            memory: 256Mi
        volumeMounts:
        - name: varlog
          mountPath: /var/log
          readOnly: true
      volumes:
      - name: varlog
        hostPath:
          path: /var/log
      hostNetwork: true
      hostPID: true
EOF

# 2. DaemonSet ìƒíƒœ í™•ì¸
kubectl get daemonset -n monitoring
kubectl get pods -n monitoring -o wide

# 3. ë…¸ë“œì— í…Œì¸íŠ¸ ì¶”ê°€ (ë“œë ˆì¸ ì‹œë®¬ë ˆì´ì…˜)
NODE_NAME=$(kubectl get nodes -o jsonpath='{.items[0].metadata.name}')
kubectl taint node $NODE_NAME maintenance=true:NoSchedule

# 4. DaemonSetì€ ì—¬ì „íˆ ì‹¤í–‰ ì¤‘ì¸ì§€ í™•ì¸ (toleration ë•Œë¬¸ì—)
kubectl get pods -n monitoring -o wide

# 5. í…Œì¸íŠ¸ ì œê±° (ì–¸ì½”ë“ )
kubectl taint node $NODE_NAME maintenance-

# 6. DaemonSet ì—…ë°ì´íŠ¸ í…ŒìŠ¤íŠ¸
kubectl patch daemonset log-collector -n monitoring -p '{"spec":{"template":{"spec":{"containers":[{"name":"log-collector","image":"busybox:1.36"}]}}}}'

# 7. ë¡¤ë§ ì—…ë°ì´íŠ¸ ìƒíƒœ í™•ì¸
kubectl rollout status daemonset/log-collector -n monitoring

echo "DaemonSetê³¼ ë…¸ë“œ ê´€ë¦¬ ì‘ì—…ì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤."
```

---

### ë¬¸ì œ 13: ë³µì¡í•œ ì• í”Œë¦¬ì¼€ì´ì…˜ ë””ë²„ê¹…

#### ğŸ“‹ ë¬¸ì œ
ë‹¤ì¤‘ ê³„ì¸µ ì• í”Œë¦¬ì¼€ì´ì…˜ì—ì„œ ë°œìƒí•˜ëŠ” ë³µí•©ì ì¸ ë¬¸ì œë¥¼ í•´ê²°í•˜ì„¸ìš”.

**ìš”êµ¬ì‚¬í•­:**
1. í”„ë¡ íŠ¸ì—”ë“œ, ë°±ì—”ë“œ, ë°ì´í„°ë² ì´ìŠ¤ ì—°ê²° ë¬¸ì œ í•´ê²°
2. ì„œë¹„ìŠ¤ ë””ìŠ¤ì»¤ë²„ë¦¬ ë¬¸ì œ ì§„ë‹¨
3. ë¦¬ì†ŒìŠ¤ ë¶€ì¡±ìœ¼ë¡œ ì¸í•œ ì„±ëŠ¥ ë¬¸ì œ í•´ê²°
4. ë¡œê·¸ ë¶„ì„ì„ í†µí•œ ê·¼ë³¸ ì›ì¸ íŒŒì•…

#### ğŸ› ï¸ í™˜ê²½ ì„¤ì • (KillerCodaì—ì„œ ì‹¤í–‰)

```bash
# ë„¤ì„ìŠ¤í˜ì´ìŠ¤ ìƒì„±
kubectl create namespace troubleshoot-app

# ì˜ëª»ëœ ì„¤ì •ìœ¼ë¡œ ë°±ì—”ë“œ ìƒì„±
cat <<EOF | kubectl apply -f -
apiVersion: apps/v1
kind: Deployment
metadata:
  name: backend
  namespace: troubleshoot-app
spec:
  replicas: 2
  selector:
    matchLabels:
      app: backend
  template:
    metadata:
      labels:
        app: backend
    spec:
      containers:
      - name: backend
        image: nginx:1.21
        env:
        - name: DB_HOST
          value: "wrong-database-service"  # ì˜ëª»ëœ ì„œë¹„ìŠ¤ ì´ë¦„
        - name: DB_PORT
          value: "5432"
        resources:
          requests:
            cpu: 2000m  # ê³¼ë„í•œ CPU ìš”ì²­
            memory: 4Gi  # ê³¼ë„í•œ ë©”ëª¨ë¦¬ ìš”ì²­
        ports:
        - containerPort: 80
EOF

# ì˜ëª»ëœ í¬íŠ¸ë¡œ ë°±ì—”ë“œ ì„œë¹„ìŠ¤ ìƒì„±
kubectl expose deployment backend --name=backend-service --port=8080 --target-port=8080 -n troubleshoot-app

# ë°ì´í„°ë² ì´ìŠ¤ ìƒì„± (ì˜¬ë°”ë¥¸ ì´ë¦„)
kubectl create deployment database --image=postgres:13 --env="POSTGRES_PASSWORD=secret" -n troubleshoot-app
kubectl expose deployment database --name=database-service --port=5432 -n troubleshoot-app

echo "ë¬¸ì œê°€ ìˆëŠ” ì• í”Œë¦¬ì¼€ì´ì…˜ì´ ë°°í¬ë˜ì—ˆìŠµë‹ˆë‹¤. ë””ë²„ê¹…ì„ ì‹œì‘í•˜ì„¸ìš”."
```

#### âœ… ì†”ë£¨ì…˜

```bash
# 1. ì „ì²´ ì• í”Œë¦¬ì¼€ì´ì…˜ ìƒíƒœ í™•ì¸
kubectl get all -n troubleshoot-app
kubectl get events -n troubleshoot-app --sort-by='.lastTimestamp'

# 2. Pod ìƒíƒœ ìƒì„¸ í™•ì¸
kubectl describe pods -n troubleshoot-app

# 3. ë°±ì—”ë“œ ë¦¬ì†ŒìŠ¤ ë¬¸ì œ í•´ê²°
kubectl patch deployment backend -n troubleshoot-app -p '{"spec":{"template":{"spec":{"containers":[{"name":"backend","resources":{"requests":{"cpu":"100m","memory":"128Mi"}}}]}}}}'

# 4. ë°±ì—”ë“œ í™˜ê²½ë³€ìˆ˜ ìˆ˜ì • (ì˜¬ë°”ë¥¸ ë°ì´í„°ë² ì´ìŠ¤ ì„œë¹„ìŠ¤ ì´ë¦„)
kubectl patch deployment backend -n troubleshoot-app -p '{"spec":{"template":{"spec":{"containers":[{"name":"backend","env":[{"name":"DB_HOST","value":"database-service"},{"name":"DB_PORT","value":"5432"}]}]}}}}'

# 5. ë°±ì—”ë“œ ì„œë¹„ìŠ¤ í¬íŠ¸ ë¬¸ì œ í•´ê²°
kubectl patch service backend-service -n troubleshoot-app -p '{"spec":{"ports":[{"port":8080,"targetPort":80}]}}'

# 6. ì„œë¹„ìŠ¤ ì—°ê²° í…ŒìŠ¤íŠ¸
kubectl run test-connectivity --image=busybox:1.35 -n troubleshoot-app --rm -it --restart=Never -- sh -c "
echo 'Testing backend service...'
nslookup backend-service.troubleshoot-app.svc.cluster.local
wget -qO- --timeout=5 http://backend-service:8080 || echo 'Connection failed'
echo 'Testing database service...'
nslookup database-service.troubleshoot-app.svc.cluster.local
"

# 7. ì„œë¹„ìŠ¤ ì—”ë“œí¬ì¸íŠ¸ í™•ì¸
kubectl get endpoints -n troubleshoot-app

# 8. ìµœì¢… ìƒíƒœ í™•ì¸
kubectl get pods -n troubleshoot-app
kubectl get svc -n troubleshoot-app

echo "ì• í”Œë¦¬ì¼€ì´ì…˜ ë””ë²„ê¹…ì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤."
```

---

### ë¬¸ì œ 14: í´ëŸ¬ìŠ¤í„° ì„±ëŠ¥ ìµœì í™”

#### ğŸ“‹ ë¬¸ì œ
í´ëŸ¬ìŠ¤í„°ì˜ ì„±ëŠ¥ ë¬¸ì œë¥¼ ì§„ë‹¨í•˜ê³  ìµœì í™”í•˜ì„¸ìš”.

**ìš”êµ¬ì‚¬í•­:**
1. ë¦¬ì†ŒìŠ¤ ì‚¬ìš©ëŸ‰ì´ ë†’ì€ Pod ì‹ë³„
2. ë…¸ë“œ ë¦¬ì†ŒìŠ¤ ë¶€ì¡± ë¬¸ì œ í•´ê²°
3. HPA ì„¤ì • ìµœì í™”
4. ë¦¬ì†ŒìŠ¤ ì¿¼í„° ë° ì œí•œ ì¡°ì •

#### ğŸ› ï¸ í™˜ê²½ ì„¤ì • (KillerCodaì—ì„œ ì‹¤í–‰)

```bash
# ë„¤ì„ìŠ¤í˜ì´ìŠ¤ ìƒì„±
kubectl create namespace performance-test

# ì œí•œì ì¸ ë¦¬ì†ŒìŠ¤ ì¿¼í„° ì„¤ì •
cat <<EOF | kubectl apply -f -
apiVersion: v1
kind: ResourceQuota
metadata:
  name: tight-quota
  namespace: performance-test
spec:
  hard:
    requests.cpu: "1"
    requests.memory: 1Gi
    limits.cpu: "2"
    limits.memory: 2Gi
EOF

echo "ì„±ëŠ¥ í…ŒìŠ¤íŠ¸ í™˜ê²½ì´ ì„¤ì •ë˜ì—ˆìŠµë‹ˆë‹¤."
```

#### âœ… ì†”ë£¨ì…˜

```bash
# 1. ë¦¬ì†ŒìŠ¤ ì¿¼í„° ìƒíƒœ í™•ì¸
kubectl describe resourcequota tight-quota -n performance-test

# 2. ë¦¬ì†ŒìŠ¤ ì¿¼í„° ì¡°ì •
kubectl patch resourcequota tight-quota -n performance-test -p '{"spec":{"hard":{"requests.cpu":"2","requests.memory":"2Gi","limits.cpu":"4","limits.memory":"4Gi"}}}'

# 3. ìµœì í™”ëœ ì• í”Œë¦¬ì¼€ì´ì…˜ ë°°í¬
cat <<EOF | kubectl apply -f -
apiVersion: apps/v1
kind: Deployment
metadata:
  name: optimized-app
  namespace: performance-test
spec:
  replicas: 3
  selector:
    matchLabels:
      app: optimized-app
  template:
    metadata:
      labels:
        app: optimized-app
    spec:
      containers:
      - name: app
        image: nginx:1.21
        resources:
          requests:
            cpu: 200m
            memory: 256Mi
          limits:
            cpu: 400m
            memory: 512Mi
EOF

# 4. HPA ì„¤ì •ìœ¼ë¡œ ìë™ ìŠ¤ì¼€ì¼ë§ êµ¬í˜„
cat <<EOF | kubectl apply -f -
apiVersion: autoscaling/v2
kind: HorizontalPodAutoscaler
metadata:
  name: optimized-app-hpa
  namespace: performance-test
spec:
  scaleTargetRef:
    apiVersion: apps/v1
    kind: Deployment
    name: optimized-app
  minReplicas: 2
  maxReplicas: 5
  metrics:
  - type: Resource
    resource:
      name: cpu
      target:
        type: Utilization
        averageUtilization: 70
  - type: Resource
    resource:
      name: memory
      target:
        type: Utilization
        averageUtilization: 80
EOF

# 5. ì„œë¹„ìŠ¤ ìƒì„± ë° ë…¸ì¶œ
kubectl expose deployment optimized-app --name=app-service --port=80 -n performance-test

# 6. ë¶€í•˜ í…ŒìŠ¤íŠ¸ ì‹¤í–‰
kubectl run load-generator --image=busybox:1.35 -n performance-test --rm -it --restart=Never -- sh -c "
while true; do
  wget -q -O- http://app-service.performance-test.svc.cluster.local
  sleep 0.1
done
" &

# 7. HPA ë™ì‘ ëª¨ë‹ˆí„°ë§
kubectl get hpa -n performance-test -w &
sleep 60

# 8. ë¶€í•˜ í…ŒìŠ¤íŠ¸ ì¤‘ì§€
pkill -f "wget.*app-service"

# 9. ìµœì¢… ë¦¬ì†ŒìŠ¤ ì‚¬ìš©ëŸ‰ í™•ì¸
kubectl top pods -n performance-test
kubectl describe resourcequota tight-quota -n performance-test

echo "í´ëŸ¬ìŠ¤í„° ì„±ëŠ¥ ìµœì í™”ê°€ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤."
```

---

### ë¬¸ì œ 15: ì„œë¹„ìŠ¤ ë©”ì‹œ ë° ë¡œë“œ ë°¸ëŸ°ì‹±

#### ğŸ“‹ ë¬¸ì œ
ê³ ê¸‰ ë¡œë“œ ë°¸ëŸ°ì‹±ê³¼ ì„œë¹„ìŠ¤ ë©”ì‹œ ê¸°ëŠ¥ì„ êµ¬í˜„í•˜ì„¸ìš”.

**ìš”êµ¬ì‚¬í•­:**
1. ì„¸ì…˜ ì–´í”¼ë‹ˆí‹°ê°€ ìˆëŠ” ì„œë¹„ìŠ¤ ìƒì„±
2. ê°€ì¤‘ì¹˜ ê¸°ë°˜ ë¼ìš°íŒ… êµ¬í˜„
3. í—¬ìŠ¤ ì²´í¬ ë° ì¤€ë¹„ì„± í”„ë¡œë¸Œ ì„¤ì •
4. ì„œë¹„ìŠ¤ ê°„ í†µì‹  ìµœì í™”

#### ğŸ› ï¸ í™˜ê²½ ì„¤ì • (KillerCodaì—ì„œ ì‹¤í–‰)

```bash
# ë„¤ì„ìŠ¤í˜ì´ìŠ¤ ìƒì„±
kubectl create namespace service-mesh

echo "ì„œë¹„ìŠ¤ ë©”ì‹œ í™˜ê²½ì´ ì„¤ì •ë˜ì—ˆìŠµë‹ˆë‹¤."
```

#### âœ… ì†”ë£¨ì…˜

```bash
# 1. ì„¸ì…˜ ì–´í”¼ë‹ˆí‹°ê°€ ìˆëŠ” ì„œë¹„ìŠ¤ ìƒì„±
cat <<EOF | kubectl apply -f -
apiVersion: apps/v1
kind: Deployment
metadata:
  name: user-service-v1
  namespace: service-mesh
spec:
  replicas: 3
  selector:
    matchLabels:
      app: user-service
      version: v1
  template:
    metadata:
      labels:
        app: user-service
        version: v1
    spec:
      containers:
      - name: user-service
        image: nginx:1.21
        ports:
        - containerPort: 80
        livenessProbe:
          httpGet:
            path: /
            port: 80
          initialDelaySeconds: 30
          periodSeconds: 10
        readinessProbe:
          httpGet:
            path: /
            port: 80
          initialDelaySeconds: 5
          periodSeconds: 5
        resources:
          requests:
            cpu: 100m
            memory: 128Mi
          limits:
            cpu: 500m
            memory: 512Mi
EOF

# 2. ì„¸ì…˜ ì–´í”¼ë‹ˆí‹° ì„œë¹„ìŠ¤ ìƒì„±
cat <<EOF | kubectl apply -f -
apiVersion: v1
kind: Service
metadata:
  name: user-service
  namespace: service-mesh
spec:
  selector:
    app: user-service
  ports:
  - port: 80
    targetPort: 80
  sessionAffinity: ClientIP
  sessionAffinityConfig:
    clientIP:
      timeoutSeconds: 3600
EOF

# 3. ë‘ ë²ˆì§¸ ë²„ì „ì˜ ì„œë¹„ìŠ¤ ìƒì„± (ê°€ì¤‘ì¹˜ ë¼ìš°íŒ…ìš©)
cat <<EOF | kubectl apply -f -
apiVersion: apps/v1
kind: Deployment
metadata:
  name: user-service-v2
  namespace: service-mesh
spec:
  replicas: 1
  selector:
    matchLabels:
      app: user-service
      version: v2
  template:
    metadata:
      labels:
        app: user-service
        version: v2
    spec:
      containers:
      - name: user-service
        image: nginx:1.22  # ë‹¤ë¥¸ ë²„ì „
        ports:
        - containerPort: 80
        livenessProbe:
          httpGet:
            path: /
            port: 80
          initialDelaySeconds: 30
          periodSeconds: 10
        readinessProbe:
          httpGet:
            path: /
            port: 80
          initialDelaySeconds: 5
          periodSeconds: 5
        resources:
          requests:
            cpu: 100m
            memory: 128Mi
          limits:
            cpu: 500m
            memory: 512Mi
EOF

# 4. í—¬ìŠ¤ ì²´í¬ í…ŒìŠ¤íŠ¸ìš© í´ë¼ì´ì–¸íŠ¸ ìƒì„±
cat <<EOF | kubectl apply -f -
apiVersion: v1
kind: Pod
metadata:
  name: client-pod
  namespace: service-mesh
spec:
  containers:
  - name: client
    image: busybox:1.35
    command: ['sleep', '3600']
EOF

# 5. ì„œë¹„ìŠ¤ ìƒíƒœ í™•ì¸
kubectl get svc -n service-mesh
kubectl get endpoints -n service-mesh

# 6. ì„¸ì…˜ ì–´í”¼ë‹ˆí‹° í…ŒìŠ¤íŠ¸
kubectl exec -it client-pod -n service-mesh -- sh -c "
for i in \$(seq 1 10); do
  echo \"Request \$i:\"
  wget -qO- http://user-service.service-mesh.svc.cluster.local | grep -o 'nginx/[0-9.]*'
  sleep 1
done
"

# 7. íŠ¸ë˜í”½ ë¶„ì‚° í™•ì¸ (v1ê³¼ v2 ê°„)
kubectl exec -it client-pod -n service-mesh -- sh -c "
for i in \$(seq 1 20); do
  wget -qO- http://user-service.service-mesh.svc.cluster.local | grep -o 'nginx/[0-9.]*'
done | sort | uniq -c
"

echo "ì„œë¹„ìŠ¤ ë©”ì‹œ ë° ë¡œë“œ ë°¸ëŸ°ì‹± ì„¤ì •ì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤."
```

---

## ğŸ¯ Part 2 ì™„ë£Œ ì²´í¬ë¦¬ìŠ¤íŠ¸

### âœ… ì™„ë£Œëœ ê³ ê¸‰ ì˜ì—­

1. **ë°°ì¹˜ ì²˜ë¦¬** âœ…
   - Jobê³¼ CronJob ê´€ë¦¬
   - ë³‘ë ¬ ì²˜ë¦¬ ë° ì¬ì‹œë„ ì •ì±…

2. **ì‹œìŠ¤í…œ ê´€ë¦¬** âœ…
   - DaemonSetê³¼ ë…¸ë“œ ê´€ë¦¬
   - ë¡¤ë§ ì—…ë°ì´íŠ¸ ì „ëµ

3. **ë¬¸ì œ í•´ê²°** âœ…
   - ë³µì¡í•œ ì• í”Œë¦¬ì¼€ì´ì…˜ ë””ë²„ê¹…
   - í´ëŸ¬ìŠ¤í„° ì„±ëŠ¥ ìµœì í™”

4. **ê³ ê¸‰ ë„¤íŠ¸ì›Œí‚¹** âœ…
   - ì„œë¹„ìŠ¤ ë©”ì‹œ ë° ë¡œë“œ ë°¸ëŸ°ì‹±
   - ì„¸ì…˜ ì–´í”¼ë‹ˆí‹° êµ¬ì„±

### ğŸš€ ë‹¤ìŒ ë‹¨ê³„

ì´ì œ **ì‹¤ì „ ì‹œí—˜ íŒ¨í„´** ë¬¸ì„œë¡œ ìµœì¢… ì ê²€ì„ ì§„í–‰í•˜ì„¸ìš”!

---

**ğŸ‰ CKA 2025 í†µí•© ì‹¤ìŠµì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤!**
**ì‹¤ì œ ì‹œí—˜ì—ì„œ ìì‹  ìˆê²Œ ë¬¸ì œë¥¼ í•´ê²°í•  ìˆ˜ ìˆì„ ê²ƒì…ë‹ˆë‹¤! ğŸš€**